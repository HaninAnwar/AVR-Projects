#include "STD_TYPES.h"
#include <util/delay.h>

#include "DIO_interface.h"
#include "PORT_interface.h"
#include "EXTI_interface.h"
#include "GIE_interface.h"
#include "TIMER_interface.h"

#include "CLCD_interface.h"
#include "MOTOR_interface.h"
#include "MAPPING.h"


void Ultrasonic_Func(void);

void main (void)
{
	PORT_voidInit();
	CLCD_voidInit();

	TIMER1_u8Init(TIMER1_CHANNEL_A,NORMAL,DISCONNECT,TIMER_DIV_BY_1);
	ICU_voidEnableControl(RISING_EDGE);

	TIMER_u8SetCallBack(TIMER1_ICU_INT,&Ultrasonic_Func)
	GIE_voidEnable();


	DC_Motor Motor1 ,Motor2 ,Motor3 ,Motor4;

	Motor1.Port = DIO_u8PORTA;
	Motor1.Pin1 = DIO_u8PIN0;
	Motor1.Pin2 = DIO_u8PIN1;

	Motor2.Port = DIO_u8PORTA;
	Motor2.Pin1 = DIO_u8PIN2;
	Motor2.Pin2 = DIO_u8PIN3;


	Motor3.Port = DIO_u8PORTA;
	Motor3.Pin1 = DIO_u8PIN3;
	Motor3.Pin2 = DIO_u8PIN4;

	Motor4.Port = DIO_u8PORTA;
	Motor4.Pin1 = DIO_u8PIN5;
	Motor4.Pin2 = DIO_u8PIN6;

	u8 Local_u8Value,Local_u8Temp;
	while(1)
	{

//		CLCD_voidSendCommand(1);
		DIO_u8SetPinValue(DIO_u8PORTD,DIO_u8PIN7,DIO_u8PIN_HIGH);
		_delay_us(10);
		DIO_u8SetPinValue(DIO_u8PORTD,DIO_u8PIN7,DIO_u8PIN_LOW);


	}
}

void Ultrasonic_Func(void)
{
	static u8 Local_u8Counter = 0;
	u8 Local_u8StartPulse;

	Local_u8StartPulse = ICU_u16ReadingICU();
	ICU_voidSetTiggerEdge(FALLING_EDGE);
}
